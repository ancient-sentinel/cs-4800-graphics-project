# Object Tracking Research

## **Links**

- [Simple object tracking with OpenCV](https://www.pyimagesearch.com/2018/07/23/simple-object-tracking-with-opencv/) 
- [Zero to Hero: A Quick Guide to Object Tracking: MDNET, GOTURN, ROLO](https://cv-tricks.com/object-tracking/quick-guide-mdnet-goturn-rolo/)
- [Zero to Hero: Guide to Object Detection using Deep Learning: Faster R-CNN, YOLO, SSD](https://cv-tricks.com/object-detection/faster-r-cnn-yolo-ssd/)
- [GOTURN: Deep Learning based Object Tracking](https://www.learnopencv.com/goturn-deep-learning-based-object-tracking/)
 - [Object Tracking using OpenCV](https://www.learnopencv.com/object-tracking-using-opencv-cpp-python/)
 - [MultiTracker: Multiple Object Tracking using OpenCV](https://www.learnopencv.com/multitracker-multiple-object-tracking-using-opencv-c-python/)

## **Notes**

## *Simple object tracking with OpenCV*
| [Link](https://www.pyimagesearch.com/2018/07/23/simple-object-tracking-with-opencv/) |

  > Object tracking using a centroid tracking algorithm with OpenCV. Provides a simple framework for tracking objects when bounding-box coordinates for the objects can be provided for every frame. The bounding-box coordinates are then reduced to their centroid and centroids are matched across frames according to the assumption that the difference in position for a particular object between frames is smaller than all other distances between objects. Objects that are lost or disappear are deregistered when they cannot be matched to any existing objects for a certain number of frames. 


## *Zero to Hero: A Quick Guide to Object Tracking: MDNET, GOTURN, ROLO*
| [Link](https://cv-tricks.com/object-tracking/quick-guide-mdnet-goturn-rolo/) |

  > Describes various options for Object-tracking Convolutional Neural Networks. The description of the required components and general process for construction of an object tracking system might be useful. In terms of particular algoriths, the most useful for this particular project would likely be the GOTURN algorithm (which is integrated into the OpenCV tracking API).

  * Generic Object Tracking Using Regression Networks (GOTURN) 
      - Trained using thousands of videos for general object tracking
      - Can typically track objects not in the original training set once fully trained
      - Need to investigate how targeted training might perform vs. just trying to find a pre-trained, general implementation 
      - Can run very fast (potentially 100fps or better on GPU powered machine)
      - built into the OpenCV tracking API

## *Zero to Hero: Guide to Object Detection using Deep Learning: Faster R-CNN, YOLO, SSD*
| [Link](https://cv-tricks.com/object-detection/faster-r-cnn-yolo-ssd/) |

  > Provides an introduction to Object Detection concepts and popular algorithms. 

  * Object Detection = Classification + Localization
  * 5 variables to uniquely identify object:
    - **class_name**
    - **bounding_box_top_left_x_coord**
    - **bounding_box_top_left_y_coord**
    - **bounding_box_width**
    - **bounding_box_height**
  
  ### Algorithms:

  * Histogram of Oriented Gradients (HOG)
    - "Hog features are computationally inexpensive and are good for many real-world problems"
    - "On each window obtained from running the sliding window on the pyramid, we calculate Hog Features which are fed to an SVM(Support vector machine) to create classifiers"
    - Can be run real time
    - Works well for many use cases
  * Region-based Convolutional Neural Networks (R-CNN)
    - uses Selective Search to reduce the number of bounding boxes fed to the classifier
    - Process:
      1. Run Selective Search to generate probable objects.
      2. Feed these patches to CNN, followed by SVM to predict the class of each patch.
      3. Optimize patches by training bouding box regression separately

      ![R-CNN Visualization](http://cv-tricks.com/wp-content/uploads/2017/12/RCNN-e1514378306435.jpg)
    - slow process
  * Spacial Pyramid Pooling (SPP-net)
    - "With SPP-net, we calculate the CNN representation for entire image only once and can use that to calculate the CNN representation for each patch generated by Selective Search"
    - "It uses spatial pooling after the last convolutional layer as opposed to traditionally used max-pooling. SPP layer divides a region of any arbitrary size into a constant number of bins and max pool is performed on each of the bins."
    - down-side: not trivial to perform back-propagation through spatial pooling layer
  * Fast R-CNN
    - possible to train end-to-end
    - "It uses a simple back-propagation calculation which is very similar to max-pooling gradient calculation with the exception that pooling regions overlap and therefore a cell can have gradients pumping in from multiple regions"
    - "One more thing that Fast RCNN did that they added the bounding box regression to the neural network training itself."
  * Faster R-CNN
    - "Slowest part in Fast RCNN was Selective Search or Edge boxes. Faster RCNN replaces selective search with a very small convolutional network called Region Proposal Network to generate regions of Interests."

    ![Faster R-CNN pipeline](https://cv-tricks.com/wp-content/uploads/2017/12/Faster-RCNN-CV-Tricks-1.jpg)

    - 10x faster than Fast R-CNN w/ similar accuracy on datasets like VOC-2007
    - Test Time per image = 0.2s 
  * You Only Look Once (YOLO)
    - "YOLO divides each image into a grid of S x S and each grid predicts N bounding boxes and confidence. The confidence reflects the accuracy of the bounding box and whether the bounding box actually contains an object(regardless of class). YOLO also predicts the classification score for each box for every class in training. You can combine both the classes to calculate the probability of each class being present in a predicted box."
    - Most boxes have low confidence so setting threshold (e.g. 30% confidence) can remove most of them

    ![YOLO visualization](http://cv-tricks.com/wp-content/uploads/2017/12/model2-1024x280.jpg)

    - At runtime, image goes through CNN once 
    - YOLO sees the complete image at once as opposed to looking at only a generated region
    - Weakness: can only predict 1 type of class in one grid, so struggles with very small objects
  * Single Shot Detector (SSD)
    - CNN runs on image once and calculates a feature map
    - Then, small 3x3 convolutional kernel runs on this feauture map to predict the bounding boxes and classification probability 
    - "also uses anchor boxes at various aspect ratio similar to Faster-RCNN and learns the off-set rather than learning the box"
    - predicts bounding boxes after multiple convolutional layers
  * Algorithm Comparison:

    ![Algorithm Speed vs. Accuracy](https://cv-tricks.com/wp-content/uploads/2017/12/Various-detectors-2.jpg)

    - SSD can run on video and the accuracy trade-off is low

    ![Algorithm Accuracy for Different Object Sizes](https://cv-tricks.com/wp-content/uploads/2017/12/Size-wise-comparison-of-various-detectors.png.pagespeed.ce.w6Qb-GBxsl.png)

    - SSD loses accuracy as object size decreases